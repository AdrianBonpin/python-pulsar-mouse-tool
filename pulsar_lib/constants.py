import enum


VENDOR_ID = 0x3554
WIRELESS_1KHZ_DEVICE_ID = 0xf508
WIRED_DEVICE_ID = 0xf507

INTERFACES = {
    0: {'endpoint': 0x81, 'length': 8},
    1: {'endpoint': 0x82, 'length': 17},
    2: {'endpoint': 0x83, 'length': 7},
}

PAYLOAD_HEADER = 0x08


class Command(enum.IntEnum):
    ACTIVE_PROFILE_GET = 0x0e
    ACTIVE_PROFILE_SET = 0x0f
    DEVICE_EVENT = 0x0a
    MEM_GET = 0x08
    MEM_SET = 0x07
    POWER = 0x04
    RESTORE = 0x09
    STATUS = 0x03


PollingRateHz = {
    1000: 0x01,
    500: 0x02,
    250: 0x04,
    125: 0x08,
}


class LEDEffect(enum.IntEnum):
    BREATHE = 0x02
    STEADY = 0x01


class ButtonMode(enum.IntEnum):
    CUSTOM1 = 0x05
    DISABLED = 0x00
    DPI_CHANGE = 0x02
    DPI_LOCK = 0x0a
    MOUSE = 0x01
    PROFILE_CHANGE = 0x09


class MouseKey(enum.IntEnum):
    LEFT = 0x01
    RIGHT = 0x02
    WHEEL = 0x04
    BACK = 0x08
    FORWARD = 0x10


class DPIChangeKey(enum.IntEnum):
    LOOP = 0x01
    PLUS = 0x02
    MINUS = 0x03


class DeviceEvent(enum.IntEnum):
    POWER = 0x40
    DPI_MODE = 0x01
    UNKNOWN_1 = 0x04


class Bool(enum.IntEnum):
    TRUE = 0x01
    FALSE = 0x00


DEBOUNCE_TIME_MIN = 0x00
DEBOUNCE_TIME_MAX = 0x1e

LOD_MM_MIN = 0x01
LOD_MM_MAX = 0x02

DPI_MODE_MIN = 0x00
DPI_MODE_MAX = 0x03

DPI_LOCK_MIN = 0x00
DPI_LOCK_MAX = 0x15

AUTOSLEEP_TIME_MIN = 0x01
AUTOSLEEP_TIME_MAX = 0x3c

LED_BRIGHTNESS_MIN = 0x00
LED_BRIGHTNESS_MAX = 0xff

LED_BREATHE_SPEED_MIN = 0x01
LED_BREATHE_SPEED_MAX = 0x05

DPI_MODE_CT_MIN = 0x01
DPI_MODE_CT_MAX = 0x04

DPI_MIN = 50
DPI_MAX = 26000

ADDR_POLLING_RATE = 0x00
ADDR_POLLING_RATE_CHECKSUM = 0x01
ADDR_DPI_MODE_CT = 0x02
ADDR_DPI_MODE_CT_CHECKSUM = 0x03
ADDR_DPI_MODE = 0x04
ADDR_DPI_MODE_CHECKSUM = 0x05
ADDR_LOD_MM = 0x0a
ADDR_LOD_MM_CHECKSUM = 0x0b
ADDR_MODE0_DPI_INDEX1 = 0x0c
ADDR_MODE0_DPI_INDEX2 = 0x0d
ADDR_MODE0_DPI_INDEX3 = 0x0e
ADDR_MODE0_DPI_CHECKSUM = 0x0f
ADDR_MODE1_DPI_INDEX1 = 0x10
ADDR_MODE1_DPI_INDEX2 = 0x11
ADDR_MODE1_DPI_INDEX3 = 0x12
ADDR_MODE1_DPI_CHECKSUM = 0x13
ADDR_MODE2_DPI_INDEX1 = 0x14
ADDR_MODE2_DPI_INDEX2 = 0x15
ADDR_MODE2_DPI_INDEX3 = 0x16
ADDR_MODE2_DPI_CHECKSUM = 0x17
ADDR_MODE3_DPI_INDEX1 = 0x18
ADDR_MODE3_DPI_INDEX2 = 0x19
ADDR_MODE3_DPI_INDEX3 = 0x1a
ADDR_MODE3_DPI_CHECKSUM = 0x1b
ADDR_MODE0_LED_COLOR_R = 0x2c
ADDR_MODE0_LED_COLOR_G = 0x2d
ADDR_MODE0_LED_COLOR_B = 0x2e
ADDR_MODE0_LED_COLOR_CHECKSUM = 0x2f
ADDR_MODE1_LED_COLOR_R = 0x30
ADDR_MODE1_LED_COLOR_G = 0x31
ADDR_MODE1_LED_COLOR_B = 0x32
ADDR_MODE1_LED_COLOR_CHECKSUM = 0x33
ADDR_MODE2_LED_COLOR_R = 0x34
ADDR_MODE2_LED_COLOR_G = 0x35
ADDR_MODE2_LED_COLOR_B = 0x36
ADDR_MODE2_LED_COLOR_CHECKSUM = 0x37
ADDR_MODE3_LED_COLOR_R = 0x38
ADDR_MODE3_LED_COLOR_G = 0x39
ADDR_MODE3_LED_COLOR_B = 0x3a
ADDR_MODE3_LED_COLOR_CHECKSUM = 0x3b
ADDR_LED_EFFECT = 0x4c
ADDR_LED_EFFECT_CHECKSUM = 0x4d
ADDR_LED_BRIGHTNESS = 0x4e
ADDR_LED_BRIGHTNESS_CHECKSUM = 0x4f
ADDR_LED_BREATHE_SPEED = 0x50
ADDR_LED_BREATHE_SPEED_CHECKSUM = 0x51
ADDR_LED_ENABLED = 0x52
ADDR_LED_ENABLED_CHECKSUM = 0x53
ADDR_BUTTON_LEFT_MODE = 0x60
ADDR_BUTTON_LEFT_INDEX2 = 0x61
ADDR_BUTTON_LEFT_INDEX3 = 0x62
ADDR_BUTTON_LEFT_CHECKSUM = 0x63
ADDR_BUTTON_RIGHT_MODE = 0x64
ADDR_BUTTON_RIGHT_INDEX2 = 0x65
ADDR_BUTTON_RIGHT_INDEX3 = 0x66
ADDR_BUTTON_RIGHT_CHECKSUM = 0x67
ADDR_BUTTON_WHEEL_MODE = 0x68
ADDR_BUTTON_WHEEL_INDEX2 = 0x69
ADDR_BUTTON_WHEEL_INDEX3 = 0x6a
ADDR_BUTTON_WHEEL_CHECKSUM = 0x6b
ADDR_BUTTON_BACK_MODE = 0x6c
ADDR_BUTTON_BACK_INDEX2 = 0x6d
ADDR_BUTTON_BACK_INDEX3 = 0x6e
ADDR_BUTTON_BACK_CHECKSUM = 0x6f
ADDR_BUTTON_FORWARD_MODE = 0x70
ADDR_BUTTON_FORWARD_INDEX2 = 0x71
ADDR_BUTTON_FORWARD_INDEX3 = 0x72
ADDR_BUTTON_FORWARD_CHECKSUM = 0x73
ADDR_DEBOUNCE_TIME = 0xa9
ADDR_DEBOUNCE_TIME_CHECKSUM = 0xaa
ADDR_MOTION_SYNC = 0xab
ADDR_MOTION_SYNC_CHECKSUM = 0xac
ADDR_ANGLE_SNAPPING = 0xaf
ADDR_ANGLE_SNAPPING_CHECKSUM = 0xb0
ADDR_LOD_RIPPLE = 0xb1
ADDR_LOD_RIPPLE_CHECKSUM = 0xb2
ADDR_AUTOSLEEP_TIME = 0xb7
ADDR_AUTOSLEEP_TIME_CHECKSUM = 0xb8


ADDR_BUTTON_CUSTOM1 = (0x01, 0x20)


class CustomKey(enum.IntEnum):
    SEARCH = 0x21
    STOP = 0x26
    REFRESH = 0x27


BUTTONS_CUSTOM = {
    (0x02, 0x82, CustomKey.SEARCH,  0x02, 0x42, CustomKey.SEARCH,  0x02, 0x49): 'Search',
    (0x02, 0x82, CustomKey.STOP,    0x02, 0x42, CustomKey.STOP,    0x02, 0x3f): 'Stop',
    (0x02, 0x82, CustomKey.REFRESH, 0x02, 0x42, CustomKey.REFRESH, 0x02, 0x3d): 'Refresh',
    (0x04, 0x80, 0x01, 0x00, 0x81, 0x04, 0x00, 0x40, 0x01, 0x00, 0x41, 0x04, 0x00, 0xc5): 'Ctrl+A',
    (0x04, 0x80, 0x01, 0x00, 0x81, 0x05, 0x00, 0x40, 0x01, 0x00, 0x41, 0x05, 0x00, 0xc3): 'Ctrl+B',
}
